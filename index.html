 <!DOCTYPE html>
<html lang="zh-Hans-TW"> <!--頁面內容語言-->
    <head>
        <meta charset="UTF-8">
        <title>懸浮液劑量計算機</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 50px;
            }
            input, button{
                margin: 5px 0px;
                padding: 8px;
                font-size: 16px
            }
            #result{
                margin-top: 15px;
                font-weight: bold
            }
            #total{
                margin-top: 15px;
                font-weight: bold
            }
        </style>
    </head>
    <body>
        <h1>懸浮液劑量計算機</h1>
        <!--輸入介面-->
        <h2>基本資料</h2>
        <form id="baseData">
            <label for="weight">病患體重(kg):</label><br>
            <input type="number" id="weight" placeholder="輸入體重"><br>          
            <label for="vol">單次服用體積(ml):</label><br>
            <input type="number" id="vol" placeholder="輸入體積"><br>
            <label for="freq">療程總份數:</label><br>
            <input type="number" id="freq" placeholder="輸入份數"><br>
            <label for="er">備用份數:</label><br>
            <input type="number" id="er" placeholder="備用份數"><br>
        </form>
        <h2>藥物個別計算</h2>
        <form id="var">            
            <label for="drugName">藥物名稱:</label><br>
            <input type="text" id="drugName" placeholder="輸入藥名"><br>
            <label for="perdose">單次劑量(mg/kg):</label><br>
            <input type="number" id="perdose" placeholder="輸入劑量"><br>            
            <label for="doseunit">單位藥劑劑量(mg):</label><br>
            <input type="number" id="doseunit" placeholder="輸入劑量"><br> 
        </form>
        <div>
            <button type="button" onclick="dosage()">計算</button>
            <button type="button" onclick="apd()">新增</button>
            <button type="button" onclick="undo()">撤除運算</button>
        </div>
     
        <div id="result"></div>
        <div id="total"></div>
        <button type="button" onclick="fin()">結束計算</button>
        <!--計算腳本-->
        <script>
          function dosage(){
            let dn=document.getElementById("drugName").value;
            let w=Number(document.getElementById("weight").value);
            let pd=Number(document.getElementById("perdose").value);
            let fr=Number(document.getElementById("freq").value);
            let v=Number(document.getElementById("vol").value);
            let du=Number(document.getElementById("doseunit").value);
            let er=Number(document.getElementById("er").value);
            const result = document.getElementById("result");

            let num=[w,pd,fr,v,du];
            if (num.every(n=>n>0)&&er>=0){
              fr=fr+er;
              let pill=((w*pd*fr) / du).toFixed(2);
              let vol=(fr*v).toFixed(2);
              const lstrst=document.createElement("p")
              lstrst.textContent=`${dn || "（未命名藥物）"} 藥物單位: ${pill} 顆`
              result.appendChild(lstrst);
              document.getElementById("total").innerHTML =
                "配製為"+vol+"毫升懸浮液"; 
            }
            else{              
              alert("請輸入正確數據");

            }
          }
          function apd(){
            document.getElementById("var").reset();
          }
          function fin(){
            document.getElementById("baseData").reset();
            document.getElementById("var").reset();
            document.getElementById("result").innerHTML="";
            document.getElementById("total").innerHTML="";
          }
          function undo(){
            const result = document.getElementById("result");
            if (result.lastElementChild) {
                result.lastElementChild.remove();
            }
          }
        </script>
    </body>

</html>    


